# Vuln_NerdBerries

Социальная сеть для блоггеров, позволяющая пользователям размещать посты, подписываться на других авторов, а также присоединяться к группам.

## Установка

1. Установите зависимости, выполнив команду:

```
pip install -r requirements.txt
```
Примените миграции:
```
python manage.py migrate
```
Запустите сервер разработки:
```
python manage.py runserver
```

1. Brute Force.
url: http://127.0.0.1:8000/admin
Django изначально плохо защищен от брутфорса, например можно брутфорснуть страницу смены пароля и страницу админки.
Причем статус коды помогут различать успешные попытки от неудачных, что облегчает работу злоумышленнику.
Способ противодействия: django-defender.
Для запуска django defender необходима работа redis на localhost.

![[Pasted image 20231216124011.png]]

![[Pasted image 20231216124030.png]]

SQLI:
Следующий пример будет достаточно синтетический, ведь обычно разработчики, пишущие проект на django редко прибегают к чистому SQL, используя вместо этого ORM-систему.
Итак, у нас есть безопасное приложение с поиском и ORM:
Классическая проверка на sql инъекцию в поле поиска прошла успешно(не вызвана ошибка), следовательно нужно модифицировать нагрузку.
Мы хотим получить схему базы данных, поэтому будем использовать UNION SELECT, проверяя при этом количество столбцов изначально вызываемой таблицы.
После перебора можно достать информацию о схеме таблиц по следующему запросу:
' UNION SELECT name, null, null, null, null, null, null, null FROM sqlite_master WHERE type='table' --;
Для простоты и демонстрации мы можем просматривать полученные данные, но по сути это слепая инъекция, поэтому здесь этот трюк не сработает.
![[Pasted image 20231216222610.png]]

При слепой инъекции злоумышленник попытается подобрать данные из таблиц.
Пароли, например, злоумышленник сможет получить только хешированные, следовательно ему придется перебирать значение по какому-либо списку.


Вот защищенная версия данного кода:
![[Pasted image 20231216230622.png]]
В этой версии кода я заменил вставку значений прямо в строку SQL на использование параметров в методе `execute` вместе с списком значений. Это помогает предотвратить SQL-инъекции, так как библиотека Django обрабатывает эти параметры правильным образом, экранируя их и обеспечивая безопасность. Даже если вводимые данные замаскированы, django все равно позаботиться.


XSS:
Я добавил три версии XSS: отраженная, хранимая и на основе DOM.
http://127.0.0.1:8000/about/author/ - DOM
На странице js код, вызывающий окно с приглашением к вводу.
Js код не защищен и никак не проверяет вводимые значения.

http://127.0.0.1:8000 - хранимая
Django Template изначально защищен от уязвимости, но если поставить в каком-либо из теге safe режим, то сайт становится уязвим.
На этой странице можно постить посты, следовательно можно написать payload в поле ввода создания поста

http://127.0.0.1:8000/purchases/?status=6 - отраженная
Ввод xss из http параметра.

OS Command Ijection:
http://127.0.0.1:8000/secret/ping_site/
Пинг хостов

IDOR:
127.0.0.1:8000/posts/5/edit?from_user=<int>
Редактирование записей других пользователей

Path Traversal:
http://127.0.0.1:8000/profile/antag/
в html коде идет вызов файлов из файловой системы.


Автор:
Иван Сахневич
